---
title: 'Lab 5: Quantifying and Characterizing Landscape Patterns'
author: 'Instructor: Michael Treglia'
date: "Landscape Analysis and Modeling, The University of Tulsa, Spring 2015"
output: pdf_document
---



***Due Date: Thursday, 26 February 2015***


*There will be 10 questions for Part 1 (provided on Tuesday) and additional questions for Part 2 (provided on Thursday), for a total of 20 points. All answers are due on the date specified above. PLEASE WRITE YOUR NAME ON ALL WORK*


#Part 2: Calculating Some Surface Metrics

###Part 1 Questions - Answer the following questions as you go through this lab. Feel free to use any materials from lecture, the internet, and supplemental reading materials posted on Harvey (in particular [McGarigal, K., S. Tagil, and S. Cushman. 2009. Surface metrics: an alternative to patch metrics for the quantification of landscape structure. Landscape Ecology 24:433-450](http://link.springer.com/article/10.1007%2Fs10980-009-9327-y), and the supplement associated with it). Be sure to include your name with your answers.

1) 



##Introduction

In its current version, FRAGSTATS is a powerful tool for working with categorical raster layers. Though planned future versions will include surface metrics (as described in the [McGarigal et al. 2009[(http://link.springer.com/article/10.1007%2Fs10980-009-9327-y)] paper listed above), it that feature is not currently implemented. Surface metrics can allow you to characterize landscapes (and patches) according to continuous datasets (e.g., elevation, slope, percent canopy cover, percent Software designed to calculate surface metrics can be expensive, though we can calculate some metrics pretty easily using [R](http://www.r-project.org/). 

Though R was developed for statistical computing, the R language is a programming language that can be used for a wide variety of tasks, and it can integrate with other languages. Thus, myriad packages have been developed for importing data of various formats, and manipulating them in countless ways. For working with spatial data in particular, numerous packages are available, generally outlined in this Task View: [http://cran.r-project.org/web/views/Spatial.html](http://cran.r-project.org/web/views/Spatial.html). For this lab we will use the following packages:
  * [sp](http://cran.r-project.org/web/packages/sp/); 
  * [rgdal](http://cran.r-project.org/web/packages/rgdal/); 
  * [raster](http://cran.r-project.org/web/packages/raster/); and 
  * [rgeos](http://cran.r-project.org/web/packages/rgeos/). 
  
We will do some minor data preparation, as we did in Part 1, but this time we will use R instead of QGIS, to highlight some of what we can do in R. In your own work, you can use the tools of your preference, but be aware that both are powerful and have their own advantages (e.g., R is a simple language to program and script your work in, but might take more work to figure out commands; QGIS is a simple GUI (programming requires using Python) and it is easy to visualize what is going on).

Our analyses will focus on the 30 meter [National Elevation Dataset](http://ned.usgs.gov/) for the same areas as we used in Part 1 (near Catoosa and Claremore, Oklahoma, USA). 
    * An appropriate 1 x 1 degree tile (tile n36w096) is available on the Harvey website for this class and [here](./Misc/n37w096.zip?raw=true) as a .img file.
      * You should un-zip the file and place it in your preferred file location before conducting analyses.
      * You can also download this layer from from [The National Map Viewer](http://viewer.nationalmap.gov/viewer/). 
    
*For your own analyses, some layers that you may be interested in are Percent Impervious Cover and Percent Canopy Cover from the the [2011 National Land Cover Dataset](http://www.mrlc.gov/nlcd2011.php). You can download these for the conterminuous United States from the NLCD website, or in 3 x 3 degree tiles or state extents from [The National Map Viewer](http://viewer.nationalmap.gov/viewer/).*


##Installing and Loading R Packages

For an introduction to R and R packages, see the [Intro to R material](./Lab2_IntroToR.RMD) and the beginning of the [Lab 3 material](Lab3_Import_Regress_RipleysK.Rmd) associated with this course.

You will need to install the packages listed above. the package 'sp' comes with R, but the others need to be installed - you can do this using the 'install.packages' function. Once packages are installed, you can load them using the 'library' function. 

*Note: For Macs, check out instructions for installing rgdal and rgeos at the following link - note, you'll need to install plain geos and gdal before installing the respective R packages: [http://tlocoh.r-forge.r-project.org/mac_rgeos_rgdal.html](http://tlocoh.r-forge.r-project.org/mac_rgeos_rgdal.html)*

For example, for the raster package, use this code:

```{r, eval=FALSE, tidy=TRUE}
#To install a single package:
install.packages('raster') 

#To install multiple packages at once, follow this example:
install.packages(c('raster', 'rgeos'))

#To load packages (must be done individually for each package; when a package has dependencies, the dependencies will be loaded when you load the main package you are loading):
library(raster)
library(rgeos)
```

```{r, include=FALSE}
library(raster)
library(rgeos)
library(rgdal)
library(sp)
```

##Loading Raster Layers Into R; Finding Projection Info & Reprojecting Layer
As you get started, you should set your working directory to your desired folder location (use the 'setwd' function), where you should have the data you'll be working with stored. 

The function to import a raster is pretty simple - just the 'raster' command in the package of that name. This function is pretty flexible, and can be used to create blank rasters, or import existing raster files. You can plot a raster using the 'plot' command. *Note: with the raster package open, if you look up the help for 'plot' in R, you will be asked to chose if you help for generic plotting functions or for plotting a raster - in this case you want the help for plotting a raster.*

```{r, eval=FALSE, tidy=TRUE}
dem <- raster('imgn37w096_1.img')

#Plotting may take a minute or two - if you wait until we have clipped rasters for our focal areas, it will be much quicker as this function will  be plotting smaller areas (i.e., less pixels).
plot(dem)
```

```{r, include=FALSE}
dem <- raster('D:/TregliaFiles/GIS/Data/US_Data/NationWide/NED_30m/n37w096/imgn37w096_1.img')
```

```{r, echo=FALSE}
plot(dem)
```

